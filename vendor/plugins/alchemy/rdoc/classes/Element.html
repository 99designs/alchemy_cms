<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Element</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Element</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/app/models/element_rb.html">
                app/models/element.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                ActiveRecord::Base
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000101">all_contents_by_name</a>&nbsp;&nbsp;
      <a href="#M000102">all_contents_by_type</a>&nbsp;&nbsp;
      <a href="#M000112">available_contents</a>&nbsp;&nbsp;
      <a href="#M000099">content_by_name</a>&nbsp;&nbsp;
      <a href="#M000100">content_by_type</a>&nbsp;&nbsp;
      <a href="#M000104">create_from_scratch</a>&nbsp;&nbsp;
      <a href="#M000106">descriptions</a>&nbsp;&nbsp;
      <a href="#M000108">display_name_with_preview_text</a>&nbsp;&nbsp;
      <a href="#M000109">dom_id</a>&nbsp;&nbsp;
      <a href="#M000111">get_from_clipboard</a>&nbsp;&nbsp;
      <a href="#M000110">list_elements_by_layout</a>&nbsp;&nbsp;
      <a href="#M000113">my_description</a>&nbsp;&nbsp;
      <a href="#M000103">new_from_scratch</a>&nbsp;&nbsp;
      <a href="#M000095">next</a>&nbsp;&nbsp;
      <a href="#M000105">paste_from_clipboard</a>&nbsp;&nbsp;
      <a href="#M000096">prev</a>&nbsp;&nbsp;
      <a href="#M000107">preview_text</a>&nbsp;&nbsp;
      <a href="#M000098">remove_contents</a>&nbsp;&nbsp;
      <a href="#M000097">store_page</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">create_contents_after_create</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000104" class="method-detail">
        <a name="M000104"></a>

        <div class="method-heading">
          <a href="#M000104" class="method-signature">
          <span class="method-name">create_from_scratch</span><span class="method-args">(attributes)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Inits a new element for page as described in /config/alchemy/elements.yml
from element_name and saves it
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000104-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000104-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/element.rb, line 79</span>
79:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">create_from_scratch</span>(<span class="ruby-identifier">attributes</span>)
80:     <span class="ruby-identifier">element</span> = <span class="ruby-constant">Element</span>.<span class="ruby-identifier">new_from_scratch</span>(<span class="ruby-identifier">attributes</span>)
81:     <span class="ruby-identifier">element</span>.<span class="ruby-identifier">save!</span>
82:     <span class="ruby-identifier">element</span>
83:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000106" class="method-detail">
        <a name="M000106"></a>

        <div class="method-heading">
          <a href="#M000106" class="method-signature">
          <span class="method-name">descriptions</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000106-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000106-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/element.rb, line 95</span>
 95:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">descriptions</span>
 96:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/config/alchemy/elements.yml&quot;</span>
 97:       <span class="ruby-ivar">@elements</span> = <span class="ruby-constant">YAML</span>.<span class="ruby-identifier">load_file</span>( <span class="ruby-node">&quot;#{RAILS_ROOT}/config/alchemy/elements.yml&quot;</span> )
 98:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span> <span class="ruby-node">&quot;#{RAILS_ROOT}/vendor/plugins/alchemy/config/alchemy/elements.yml&quot;</span>
 99:       <span class="ruby-ivar">@elements</span> = <span class="ruby-constant">YAML</span>.<span class="ruby-identifier">load_file</span>( <span class="ruby-node">&quot;#{RAILS_ROOT}/vendor/plugins/alchemy/config/alchemy/elements.yml&quot;</span> )
100:     <span class="ruby-keyword kw">else</span>
101:       <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;Could not read config/alchemy/elements.yml&quot;</span>
102:     <span class="ruby-keyword kw">end</span>
103:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000111" class="method-detail">
        <a name="M000111"></a>

        <div class="method-heading">
          <a href="#M000111" class="method-signature">
          <span class="method-name">get_from_clipboard</span><span class="method-args">(clipboard)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000111-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000111-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/element.rb, line 166</span>
166:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">get_from_clipboard</span>(<span class="ruby-identifier">clipboard</span>)
167:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">clipboard</span>.<span class="ruby-identifier">blank?</span>
168:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">clipboard</span>[<span class="ruby-identifier">:element_id</span>])
169:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000110" class="method-detail">
        <a name="M000110"></a>

        <div class="method-heading">
          <a href="#M000110" class="method-signature">
          <span class="method-name">list_elements_by_layout</span><span class="method-args">(layout = &quot;standard&quot;)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
List all elements by from page_layout
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000110-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000110-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/element.rb, line 152</span>
152:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">list_elements_by_layout</span>(<span class="ruby-identifier">layout</span> = <span class="ruby-value str">&quot;standard&quot;</span>)
153:     <span class="ruby-identifier">elements</span> = <span class="ruby-constant">Element</span>.<span class="ruby-identifier">descriptions</span>
154:     <span class="ruby-identifier">result</span> = []
155:     <span class="ruby-identifier">page_layouts</span> = <span class="ruby-constant">PageLayout</span>.<span class="ruby-identifier">get</span>
156:     <span class="ruby-identifier">layout_elements</span> = <span class="ruby-identifier">page_layouts</span>.<span class="ruby-identifier">select</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>[<span class="ruby-value str">&quot;name&quot;</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">layout</span>}.<span class="ruby-identifier">first</span>[<span class="ruby-value str">&quot;elements&quot;</span>]
157:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">elements</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">layout_elements</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;all&quot;</span>
158:     <span class="ruby-identifier">elements</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">element</span><span class="ruby-operator">|</span>
159:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">layout_elements</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">element</span>[<span class="ruby-value str">&quot;name&quot;</span>]
160:         <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">element</span>
161:       <span class="ruby-keyword kw">end</span>
162:     <span class="ruby-keyword kw">end</span>
163:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">result</span>
164:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000103" class="method-detail">
        <a name="M000103"></a>

        <div class="method-heading">
          <a href="#M000103" class="method-signature">
          <span class="method-name">new_from_scratch</span><span class="method-args">(attributes)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Inits a new element for page as described in /config/alchemy/elements.yml
from element_name
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000103-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000103-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/element.rb, line 67</span>
67:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">new_from_scratch</span>(<span class="ruby-identifier">attributes</span>)
68:     <span class="ruby-identifier">element_scratch</span> = <span class="ruby-constant">Element</span>.<span class="ruby-identifier">descriptions</span>.<span class="ruby-identifier">select</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">m</span>[<span class="ruby-value str">&quot;name&quot;</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">attributes</span>[<span class="ruby-value str">'name'</span>] }.<span class="ruby-identifier">first</span>
69:     <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Could not find element: #{attributes['name']}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">element_scratch</span>.<span class="ruby-identifier">nil?</span>
70:     <span class="ruby-identifier">element_scratch</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value str">&quot;contents&quot;</span>)
71:     <span class="ruby-identifier">element_scratch</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value str">&quot;available_contents&quot;</span>)
72:     <span class="ruby-identifier">element</span> = <span class="ruby-constant">Element</span>.<span class="ruby-identifier">new</span>(
73:       <span class="ruby-identifier">element_scratch</span>.<span class="ruby-identifier">merge</span>({<span class="ruby-identifier">:page_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">attributes</span>[<span class="ruby-value str">'page_id'</span>]})
74:     )
75:     <span class="ruby-identifier">element</span>
76:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000105" class="method-detail">
        <a name="M000105"></a>

        <div class="method-heading">
          <a href="#M000105" class="method-signature">
          <span class="method-name">paste_from_clipboard</span><span class="method-args">(page_id, element, method, position)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
pastes a element from the clipboard in the session to page
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000105-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000105-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/element.rb, line 86</span>
86:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">paste_from_clipboard</span>(<span class="ruby-identifier">page_id</span>, <span class="ruby-identifier">element</span>, <span class="ruby-identifier">method</span>, <span class="ruby-identifier">position</span>)
87:     <span class="ruby-identifier">copy</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">copy</span>(<span class="ruby-identifier">element</span>, <span class="ruby-identifier">:page_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">page_id</span>)
88:     <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">insert_at</span>(<span class="ruby-identifier">position</span>)
89:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">method</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;move&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">valid?</span>
90:       <span class="ruby-identifier">element</span>.<span class="ruby-identifier">destroy</span>
91:     <span class="ruby-keyword kw">end</span>
92:     <span class="ruby-identifier">copy</span>
93:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000101" class="method-detail">
        <a name="M000101"></a>

        <div class="method-heading">
          <a href="#M000101" class="method-signature">
          <span class="method-name">all_contents_by_name</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000101-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000101-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/element.rb, line 58</span>
58:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">all_contents_by_name</span>(<span class="ruby-identifier">name</span>)
59:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">contents</span>.<span class="ruby-identifier">find_all_by_name</span>(<span class="ruby-identifier">name</span>)
60:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000102" class="method-detail">
        <a name="M000102"></a>

        <div class="method-heading">
          <a href="#M000102" class="method-signature">
          <span class="method-name">all_contents_by_type</span><span class="method-args">(essence_type)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000102-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000102-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/element.rb, line 62</span>
62:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">all_contents_by_type</span>(<span class="ruby-identifier">essence_type</span>)
63:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">contents</span>.<span class="ruby-identifier">find_all_by_essence_type</span>(<span class="ruby-identifier">essence_type</span>)
64:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000112" class="method-detail">
        <a name="M000112"></a>

        <div class="method-heading">
          <a href="#M000112" class="method-signature">
          <span class="method-name">available_contents</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
returns the collection of available essence_types that can be created for
this element depending on its description in elements.yml
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000112-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000112-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/element.rb, line 172</span>
172:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">available_contents</span>
173:     <span class="ruby-identifier">my_description</span>[<span class="ruby-value str">'available_contents'</span>]
174:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000099" class="method-detail">
        <a name="M000099"></a>

        <div class="method-heading">
          <a href="#M000099" class="method-signature">
          <span class="method-name">content_by_name</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000099-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000099-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/element.rb, line 50</span>
50:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">content_by_name</span>(<span class="ruby-identifier">name</span>)
51:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">contents</span>.<span class="ruby-identifier">find_by_name</span>(<span class="ruby-identifier">name</span>)
52:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000100" class="method-detail">
        <a name="M000100"></a>

        <div class="method-heading">
          <a href="#M000100" class="method-signature">
          <span class="method-name">content_by_type</span><span class="method-args">(essence_type)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000100-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000100-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/element.rb, line 54</span>
54:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">content_by_type</span>(<span class="ruby-identifier">essence_type</span>)
55:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">contents</span>.<span class="ruby-identifier">find_by_essence_type</span>(<span class="ruby-identifier">essence_type</span>)
56:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000108" class="method-detail">
        <a name="M000108"></a>

        <div class="method-heading">
          <a href="#M000108" class="method-signature">
          <span class="method-name">display_name_with_preview_text</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000108-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000108-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/element.rb, line 143</span>
143:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">display_name_with_preview_text</span>
144:     <span class="ruby-identifier">display_name</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">preview_text</span>
145:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000109" class="method-detail">
        <a name="M000109"></a>

        <div class="method-heading">
          <a href="#M000109" class="method-signature">
          <span class="method-name">dom_id</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000109-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000109-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/element.rb, line 147</span>
147:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dom_id</span>
148:     <span class="ruby-node">&quot;#{name}_#{id}&quot;</span>
149:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000113" class="method-detail">
        <a name="M000113"></a>

        <div class="method-heading">
          <a href="#M000113" class="method-signature">
          <span class="method-name">my_description</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
returns the description of the element with my name in element.yml
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000113-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000113-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/element.rb, line 177</span>
177:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">my_description</span>
178:     <span class="ruby-constant">Element</span>.<span class="ruby-identifier">descriptions</span>.<span class="ruby-identifier">detect</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">d</span><span class="ruby-operator">|</span> <span class="ruby-identifier">d</span>[<span class="ruby-value str">&quot;name&quot;</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">name</span> }
179:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000095" class="method-detail">
        <a name="M000095"></a>

        <div class="method-heading">
          <a href="#M000095" class="method-signature">
          <span class="method-name">next</span><span class="method-args">(name = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns <a href="Element.html#M000095">next</a> <a
href="Element.html">Element</a> on self.page or nil. Pass a Element.name to
get <a href="Element.html#M000095">next</a> of this kind.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000095-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000095-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/element.rb, line 18</span>
18:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">next</span>(<span class="ruby-identifier">name</span> = <span class="ruby-keyword kw">nil</span>)
19:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">nil?</span>
20:       <span class="ruby-identifier">find_conditions</span> = [<span class="ruby-value str">&quot;public = 1 AND page_id = ? AND position &gt; ?&quot;</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">page</span>.<span class="ruby-identifier">id</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">position</span>]
21:     <span class="ruby-keyword kw">else</span>
22:       <span class="ruby-identifier">find_conditions</span> = [<span class="ruby-value str">&quot;public = 1 AND page_id = ? AND name = ? AND position &gt; ?&quot;</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">page</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">name</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">position</span>]
23:     <span class="ruby-keyword kw">end</span>
24:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">find</span> <span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">find_conditions</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;position ASC&quot;</span>
25:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000096" class="method-detail">
        <a name="M000096"></a>

        <div class="method-heading">
          <a href="#M000096" class="method-signature">
          <span class="method-name">prev</span><span class="method-args">(name = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns previous <a href="Element.html">Element</a> on self.page or nil.
Pass a Element.name to get previous of this kind.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000096-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000096-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/element.rb, line 28</span>
28:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prev</span>(<span class="ruby-identifier">name</span> = <span class="ruby-keyword kw">nil</span>)
29:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">nil?</span>
30:       <span class="ruby-identifier">find_conditions</span> = [<span class="ruby-value str">&quot;public = 1 AND page_id = ? AND position &lt; ?&quot;</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">page</span>.<span class="ruby-identifier">id</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">position</span>]
31:     <span class="ruby-keyword kw">else</span>
32:       <span class="ruby-identifier">find_conditions</span> = [<span class="ruby-value str">&quot;public = 1 AND page_id = ? AND name = ? AND position &lt; ?&quot;</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">page</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">name</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">position</span>]
33:     <span class="ruby-keyword kw">end</span>
34:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">find</span> <span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">find_conditions</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;position DESC&quot;</span>
35:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000107" class="method-detail">
        <a name="M000107"></a>

        <div class="method-heading">
          <a href="#M000107" class="method-signature">
          <span class="method-name">preview_text</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Selects the content in the element.yml description that is flagged as
take_me_for_preview or takes the first content if only one content exists
for element. Then selects the content from the element that is equivalent
to this flagged content to display its contect as preview text for element
editor
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000107-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000107-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/element.rb, line 107</span>
107:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">preview_text</span>
108:     <span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;&quot;</span>
109:     <span class="ruby-keyword kw">begin</span>
110:       <span class="ruby-identifier">my_contents</span> = <span class="ruby-identifier">my_description</span>[<span class="ruby-value str">&quot;contents&quot;</span>]
111:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">my_contents</span>.<span class="ruby-identifier">blank?</span>
112:         <span class="ruby-identifier">content_flagged_as_preview</span> = <span class="ruby-identifier">my_contents</span>.<span class="ruby-identifier">select</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span>[<span class="ruby-value str">&quot;take_me_for_preview&quot;</span>] }.<span class="ruby-identifier">first</span>
113:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">content_flagged_as_preview</span>.<span class="ruby-identifier">blank?</span>
114:           <span class="ruby-identifier">content_to_take_as_preview</span> = <span class="ruby-identifier">my_contents</span>.<span class="ruby-identifier">first</span>
115:         <span class="ruby-keyword kw">else</span>
116:           <span class="ruby-identifier">content_to_take_as_preview</span> = <span class="ruby-identifier">content_flagged_as_preview</span>
117:         <span class="ruby-keyword kw">end</span>
118:         <span class="ruby-identifier">preview_content</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">contents</span>.<span class="ruby-identifier">select</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">content</span><span class="ruby-operator">|</span> <span class="ruby-identifier">content</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">content_to_take_as_preview</span>[<span class="ruby-value str">&quot;name&quot;</span>] }.<span class="ruby-identifier">first</span>
119:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">preview_content</span>.<span class="ruby-identifier">blank?</span>
120:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">preview_content</span>.<span class="ruby-identifier">essence_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;EssenceRichtext&quot;</span>
121:             <span class="ruby-identifier">text</span> = <span class="ruby-identifier">preview_content</span>.<span class="ruby-identifier">essence</span>.<span class="ruby-identifier">stripped_body</span>.<span class="ruby-identifier">to_s</span>
122:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">preview_content</span>.<span class="ruby-identifier">essence_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;EssenceText&quot;</span>
123:             <span class="ruby-identifier">text</span> = <span class="ruby-identifier">preview_content</span>.<span class="ruby-identifier">essence</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">to_s</span>
124:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">preview_content</span>.<span class="ruby-identifier">essence_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;EssencePicture&quot;</span>
125:             <span class="ruby-identifier">text</span> = (<span class="ruby-identifier">preview_content</span>.<span class="ruby-identifier">essence</span>.<span class="ruby-identifier">picture</span>.<span class="ruby-identifier">name</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-value str">&quot;&quot;</span>)
126:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">preview_content</span>.<span class="ruby-identifier">essence_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;EssenceFile&quot;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">preview_content</span>.<span class="ruby-identifier">essence_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;EssenceFlash&quot;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">preview_content</span>.<span class="ruby-identifier">essence_type</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;EssenceFlashvideo&quot;</span>
127:             <span class="ruby-identifier">text</span> = (<span class="ruby-identifier">preview_content</span>.<span class="ruby-identifier">essence</span>.<span class="ruby-identifier">file</span>.<span class="ruby-identifier">name</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-value str">&quot;&quot;</span>)
128:           <span class="ruby-keyword kw">else</span>
129:             <span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;&quot;</span>
130:           <span class="ruby-keyword kw">end</span>
131:         <span class="ruby-keyword kw">else</span>
132:           <span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;&quot;</span>
133:         <span class="ruby-keyword kw">end</span>
134:       <span class="ruby-keyword kw">end</span>
135:     <span class="ruby-keyword kw">rescue</span>
136:       <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">error</span>(<span class="ruby-node">&quot;#{$!}\n#{$@.join('\n')}&quot;</span>)
137:       <span class="ruby-identifier">text</span> = <span class="ruby-value str">&quot;&quot;</span>
138:     <span class="ruby-keyword kw">end</span>
139:     <span class="ruby-identifier">text</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">30</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">text</span> = (<span class="ruby-identifier">text</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">30</span>] <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;...&quot;</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">text</span>
140:     <span class="ruby-identifier">text</span>
141:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000098" class="method-detail">
        <a name="M000098"></a>

        <div class="method-heading">
          <a href="#M000098" class="method-signature">
          <span class="method-name">remove_contents</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000098-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000098-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/element.rb, line 44</span>
44:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_contents</span>
45:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">contents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">content</span><span class="ruby-operator">|</span>
46:       <span class="ruby-identifier">content</span>.<span class="ruby-identifier">destroy</span>
47:     <span class="ruby-keyword kw">end</span>
48:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000097" class="method-detail">
        <a name="M000097"></a>

        <div class="method-heading">
          <a href="#M000097" class="method-signature">
          <span class="method-name">store_page</span><span class="method-args">(page)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000097-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000097-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/element.rb, line 37</span>
37:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">store_page</span> <span class="ruby-identifier">page</span>
38:     <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">to_be_sweeped_pages</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">page</span>
39:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">to_be_sweeped_pages</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">page</span>
40:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">save</span>
41:     <span class="ruby-keyword kw">end</span>
42:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>