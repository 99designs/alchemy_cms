<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="<%= current_user.language.blank? ? 'de' : current_user.language rescue 'de' %>">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
		<meta http-equiv="content-language" content="<%= current_user.language.blank? ? 'de' : current_user.language rescue 'de' %>">
		<title>Alchemy <%= configuration(:alchemy_version) %></title>
		<!--[if IE 6]>
			<link rel="stylesheet" type="text/css" href="/plugin_assets/stylesheets/ie6.css" />
		<![endif]-->
		<meta name="viewport" content="width=400" />
		<%= yield :stylesheets %>
		<%= yield :javascript_includes %>
	</head>
	
	<body>
		<%#= overlay for indication of loading %>
		<div id="overlay">
			<div id="overlay_text_box">
				<%= image_tag('ajax_loader.gif', :plugin => 'alchemy', :id => 'ajax_loader') %>
				<span id="overlay_text"><%= _("please_wait") %></span>
			</div>
		</div>
		<%#= overlay end %>
		<div id="top_frame">
			<div id="wa_top_menu">
				<div id="wa_top_menu_content">
					<div id="wa_top_navi">
						<%= yield(:navigation) %>
						<%= admin_main_navigation %>
					</div>
				</div>
				<%- if current_user -%>
				<div id="wa_userinfo">
					<%= link_to(
						"&raquo; #{current_user.login} " + _("logout"),
						logout_url,
						:title => _('logout'),
						:onclick => 'pleaseWaitOverlay()'
					) %>
				</div>
				<%- end -%>
				<div id="back_to_site">
					<%= link_to "&raquo; " + _("back to site"), root_url %>
				</div>
				<div id="wa_top_menu_background"></div>
			</div>
		</div>
		<div id="left_frame" style="width: <%= yield(:framesize) || '100%' %>">
			<div id="wa_main_content">
				<%= error_messages_for( 'wa_page') %>
				<%= admin_subnavigation %>
				<%= yield %>
			</div>
		</div>
		<%- if target_url = frame_requested? -%>
		<div id="preview" style="top: 37px; left: 401px;">
			<div id="top_frame_switch">
				<img src="/plugin_assets/alchemy/images/gui/top_bar_close.gif" id="top_switch_image" onclick="switchDiv('top_frame');" alt="leftFrameSwitchArrow" />
			</div>
			<div id="left_frame_switch">
				<img src="/plugin_assets/alchemy/images/gui/left_bar_close.gif" id="left_switch_image" onclick="switchDiv('left_frame');" alt="leftFrameSwitchArrow" />
			</div>
			<iframe id="iframe" src="<%= generate_preview_url(target_url) %>" scrolling="auto" frameborder="0"></iframe>
		</div>
		<%- end -%>
		<%= yield(:javascripts) %>
		<script type="text/javascript" charset="utf-8">
		//<!--[CDATA[
			document.observe("dom:loaded", function() {
				<%- if frame_requested? -%>
				setDivStati();
				setFrameSize();
				<%- end -%>
			});
			<%- if frame_requested? -%>
			Event.observe(window, 'resize', function() {
				setFrameSize();
			});
			Event.observe(window, 'change', function() {
				setFrameSize();
			});
			<%- end -%>
		//]]-->
		</script>
	</body>
</html>
