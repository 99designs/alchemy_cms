case @wa_atom.atom_type
when "WaAtomPicture"
  page.insert_html(
    :before,
    "add_atom_#{@wa_molecule.id}",
    :partial => "wa_atom_picture_editor",
    :locals => {
      :wa_atom => @wa_atom,
      :options => @options
    }
  )
  if @dragable
    WaConfigure.sortable_atoms(page, @wa_molecule)
  end
  page << "reloadPreview()"
when "WaAtomText"
  page.insert_html(
    :before,
    "add_atom_for_molecule_#{@wa_molecule.id}",
    :partial => "wa_atom_text_editor",
    :locals => {
      :wa_atom => @wa_atom,
      :options => {:as => 'text_field'}.merge(@options.nil? ? {} : @options)
    }
  )
  page << "reloadPreview(); if(typeof(wa_overlay)!='undefined') { wa_overlay.close(); }"
when "WaAtomRtf"
  page.insert_html(
    :before,
    "add_atom_for_molecule_#{@wa_molecule.id}",
    :partial => "wa_atom_rtf_editor",
    :locals => {
      :wa_atom => @wa_atom,
      :options => (@options.nil? ? {} : @options)
    }
  )
  page.call 'TinymceHammer.init'
  page << "wa_overlay.close()"
else
  page.insert_html(
    :before,
    "add_atom_for_molecule_#{@wa_molecule.id}",
    :partial => "#{@wa_atom.atom_type.underscore}_editor",
    :locals => {
      :wa_atom => @wa_atom,
      :options => (@options.nil? ? {} : @options)
    }
  )
  page << "wa_overlay.close()"
end
WaNotice.show_via_ajax(page, _("Successfully added %{atom}") % {:atom => @wa_atom.name})
