<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<%= render_meta_data(:title_prefix => 'Page') %>
		<%= stylesheet_link_tag 'base' %>
		<%= javascript_include_tag "prototype" %>
	</head>
	<body>
		<div id="page">
			<div id="header">
				<div id="logo">
					<%= link_to "Home", root_url %>
				</div>
			</div>
			<div id="navigation">
				<%= render_navigation(:submenu => true) %>
			</div>
			<%= yield %>
		</div>
		<script type="text/javascript" charset="utf-8">
		// <![CDATA[
			var elements = $$('.alchemy_element');
			elements.each(function (el) {
				el.observe('mouseover', function (e) {
					var t = e.currentTarget;
					t.setStyle({outline: '2px solid blue'});
				});
				el.observe('mouseout', function (e) {
					var t = e.currentTarget;
					t.setStyle({outline: 'none'});
				});
				el.observe('click', function (e) {
					var target = e.currentTarget;
					var t_id = target.id.replace(/\D/g,'');
					editors = window.parent.$$('#element_area .element_editor');
					editors.each(function (ed) {
						ed.removeClassName('selected');
					});
					var cur_ed = editors.detect(function (ed) {
						var ed_id = ed.id.replace(/\D/g,'');
						return ed_id === t_id;
					});
					cur_ed.addClassName('selected');
					cur_ed.fire('alchemy:expand_element', {element_id: t_id});
					var of = cur_ed.positionedOffset();
					var par = cur_ed.getOffsetParent();
					window.parent.$$('.alchemy_window_content .alchemy_window_content').first().scrollTop = of.top;
				});
			});
		// ]]>
		</script>
	</body>
</html>
